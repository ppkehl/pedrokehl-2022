---
import Base from '../../../layouts/Base.astro'

export function getLanguageFromURL(pathname: string) {
  const langCodeMatch = pathname.match(/\/([a-z]{2}-?[A-Z]{0,2})\//);
  return langCodeMatch ? langCodeMatch[1] : 'en';
}

export async function getStaticPaths() {
  const posts = await Astro.glob('../../../data/test/**/*.md')

  const paths = posts.map(post => {

    let locale = getLanguageFromURL(post.file)

    return {
      params: {
        locale: locale,
        slug: post.frontmatter.slug 
      },
      props: {
        post
      }
    }
  })

  return paths;
}

const { locale} = Astro.params;
const { Content } = Astro.props.post

---
<Base locale={locale}>

  <Content/>
  
</Base>